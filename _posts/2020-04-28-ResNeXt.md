---
layout: post
title:  "[WIP] ResNeXt"
date:   2020-04-28 08:37:00
categories: jekyll update
---


These are my notes on the paper [Aggregated Residual Transformations for Deep Neural Networks](https://arxiv.org/abs/1611.05431). All mistakes are my own.

## ResNeXt building block

The key idea is that the $F$ channels of the input are split into $C$ parts which are then processed independently before they are finally added together. In the na√Øve version multiple parallel layers are used

![png]({{ site.baseurl }}/assets/ResNeXt/resnext_simple.jpg)

However as shown below these can be implemented more efficiently by merging the `conv1x1` layers and using group convolutions (which will have efficient GPU implementations in some frameworks) for the `conv3x3` layer.

![png]({{ site.baseurl }}/assets/ResNeXt/resnext_efficient.jpg)

## Group convolutions

Source: [ImageNet Classification with Deep Convolutional Neural Networks](https://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks.pdf)

Group convolutions are attributed to the [AlexNet paper](https://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks.pdf). In this paper they appear to have been used for computational reasons rather than as a design choice. Subsequently the motivation to use them tends to be architectural. Below is an annotated figure of the original AlexNet architecture.

![png]({{ site.baseurl }}/assets/ResNeXt/groupconv.png)

These are really rather simple. Say you have $F$ input and $F'$ output filters, each of which is divisible by $C$. Then you split the input filters into $C$ groups of $F/C$ filters each, input each of the $1, 2, \ldots, C$ groups into a separate convolutional layer and output $F'/C$ filters for each group. 

You then concatenate these outputs to yield an output with $F'$ filters. This means the first, second, etc. $F'/C$ filters of the output are only influenced by the first, second, etc $F/C$ filters of the input. At some other layer downstream, all the filters should be be mixed together in order for every filter to influence every output dimension. 



